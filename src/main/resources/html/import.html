<!DOCTYPE html>
<html>
    <head>
        <title>ChessGear</title>
        <link href="css/normalize.css" rel="stylesheet" type="text/css">
        <link href="css/style.css" rel="stylesheet" type="text/css">
        <script type="text/javascript" src="js/jquery-2.1.4.min.js"></script>
        <script type="text/javascript" src="js/js.cookie.js"></script>
    </head>
    <body>

        <div id="main-wrapper">

            <header>
                <div id="wordmark">
                    ChessGear v1.0
                </div>
                <div id="current-user">
                    | <a href="#" id="logout">logout</a>
                </div>
                <div id="nav">
                    <ul>
                        <li class="inactive-nav"><a href="index.html">Home</a></li>
                        <li class="active-nav"><a href="import.html">Import</a></li>
                        <li class="inactive-nav"><a href="account.html">Account</a></li>
                        <div class="clear"></div>
                    </ul>
                </div>
            </header>
            <main>
                
                <div id="pgn-upload">
                    <form id="pgn-submit" action="submit.php" method="post">
                        <h3>Upload a file</h3>
                        <input type="file" name="pgn-file">
                        <p style="color: #aaa; font-weight: bold;">or</p>
                        <h3>Paste in your PGN</h3>
                        <textarea rows="8" cols="80" id="pgn-body" name="pgn-body"></textarea><br>
                        <input type="submit" style="color: #000;">
                    </form>
                </div>

            </main>

            <footer>
                &copy;ChessGear 2015
            </footer>

        </div>

        <script type="text/javascript">

            $(document).ready(function() {
                var loggedInUser = Cookies.get('loggedInUser');
                if (loggedInUser != null) {
                    $("#current-user").prepend(loggedInUser);
                } else {
                    window.location.replace("welcome.html");
                }

                $("#logout").click(function (e) {
                    e.preventDefault();
                    Cookies.remove('loggedInUser');
                });

                $("#pgn-submit").submit(function(e) {
                alert("Submitted!");
                e.preventDefault();
                var pgnBody = $("#pgn-body").val();
                var postRequest = $.post("chessgear/api/games/import/" + loggedInUser, JSON.stringify({pgn : pgnBody}), function(data) {
                    alert(data);
                });
                postRequest.fail(function (data) {
                    alert("Import failed: " + data.responseText);
                });
            });
            });

            

        </script>

    </body>
</html>